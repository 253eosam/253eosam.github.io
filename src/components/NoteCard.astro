---
interface Props {
  title: string;
  date: string;
  category: string;
  description: string;
  slug: string;
  tags: string[];
}

const { title, date, category, description, slug, tags } = Astro.props;

function formatDate(dateStr: string): string {
  const [y, m, d] = dateStr.split('-');
  return `${y}. ${parseInt(m)}. ${parseInt(d)}.`;
}
---

<article class="note-card" data-category={category}>
  <a href={`/notes/${slug}`} class="card-link">
    <div class="card-meta">
      <span class="card-category">{category}</span>
      <time class="card-date" datetime={date}>{formatDate(date)}</time>
    </div>
    <h2 class="card-title">{title}</h2>
    {description && <p class="card-desc">{description}</p>}
    {
      tags.length > 0 && (
        <div class="card-tags">
          {tags.slice(0, 4).map((tag) => (
            <span class="card-tag">{tag}</span>
          ))}
          {tags.length > 4 && <span class="card-tag-more">+{tags.length - 4}</span>}
        </div>
      )
    }
  </a>
</article>

<style>
  .note-card {
    border-bottom: 1px solid var(--color-border);
  }

  .card-link {
    display: block;
    padding: var(--space-lg) 0;
    text-decoration: none;
    color: inherit;
    transition: opacity 0.15s;
  }

  .card-link:hover {
    text-decoration: none;
  }

  .card-link:hover .card-title {
    color: var(--color-primary);
  }

  .card-meta {
    display: flex;
    align-items: center;
    gap: var(--space-sm);
    margin-bottom: var(--space-xs);
  }

  .card-category {
    font-size: 0.8rem;
    font-weight: 600;
    color: var(--color-primary);
    text-transform: capitalize;
  }

  .card-date {
    font-size: 0.8rem;
    color: var(--color-text-tertiary);
  }

  .card-title {
    font-size: 1.1rem;
    font-weight: 600;
    line-height: 1.4;
    margin-bottom: var(--space-xs);
    transition: color 0.15s;
  }

  .card-desc {
    font-size: 0.9rem;
    color: var(--color-text-secondary);
    line-height: 1.6;
    display: -webkit-box;
    -webkit-line-clamp: 2;
    -webkit-box-orient: vertical;
    overflow: hidden;
  }

  .card-tags {
    display: flex;
    flex-wrap: wrap;
    gap: var(--space-xs);
    margin-top: var(--space-sm);
  }

  .card-tag {
    font-size: 0.75rem;
    background: var(--color-tag-bg);
    color: var(--color-tag-text);
    padding: 2px 8px;
    border-radius: 9999px;
  }

  .card-tag-more {
    font-size: 0.75rem;
    color: var(--color-text-tertiary);
    padding: 2px 4px;
  }
</style>
