---
interface Props {
  categories: string[];
}

const { categories } = Astro.props;
---

<nav class="filter" aria-label="카테고리 필터">
  <button class="filter-btn active" data-category="all">전체</button>
  {categories.map((cat) => <button class="filter-btn" data-category={cat}>{cat}</button>)}
</nav>

<script>
  function initFilter() {
    const buttons = document.querySelectorAll<HTMLButtonElement>('.filter-btn');
    const cards = document.querySelectorAll<HTMLElement>('.note-card');

    buttons.forEach((btn) => {
      btn.addEventListener('click', () => {
        const cat = btn.dataset.category;

        buttons.forEach((b) => b.classList.remove('active'));
        btn.classList.add('active');

        cards.forEach((card) => {
          if (cat === 'all' || card.dataset.category === cat) {
            card.style.display = '';
          } else {
            card.style.display = 'none';
          }
        });
      });
    });
  }

  initFilter();
  document.addEventListener('astro:after-swap', initFilter);
</script>

<style>
  .filter {
    display: flex;
    flex-wrap: wrap;
    gap: var(--space-sm);
    padding: var(--space-lg) 0;
  }

  .filter-btn {
    font-family: var(--font-sans);
    font-size: 0.85rem;
    font-weight: 500;
    padding: 6px 14px;
    border: 1px solid var(--color-border);
    border-radius: 9999px;
    background: var(--color-bg);
    color: var(--color-text-secondary);
    cursor: pointer;
    transition:
      background 0.15s,
      color 0.15s,
      border-color 0.15s;
    text-transform: capitalize;
  }

  .filter-btn:hover {
    border-color: var(--color-primary);
    color: var(--color-primary);
  }

  .filter-btn.active {
    background: var(--color-primary);
    color: #ffffff;
    border-color: var(--color-primary);
  }
</style>
